<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="photo.css" /><?php#Includes database functions for using MySQL and opens a connection require("db-code.php");#Defines a quick function for displaying images the correct size with alt textfunction ShowImage($filename,$alt){	$size = getimagesize ($filename);	echo "<img src=\"{$filename}\" alt=\"{$alt}\" {$size[3]} />";}function ImageLink($link,$filename,$alt){	echo "<a target=\"image\" href=\"{$link}\">";	ShowImage($filename,$alt);	echo "</a>";}# Defaults to collection 0 if no collection id sentif (!@$colid) {	$colid = 0;}$query = "SELECT * FROM collections WHERE id={$colid}";# Puts details of collection into easier variablesif(ExecuteQuery($linkdb,$result,$query)){	while($row=NextRow($result)){		$collection = $row['name'];		$intro = $row['intro'];	}}$query = "SELECT * FROM photo WHERE collection={$colid} AND active='y' ORDER BY id ASC LIMIT 1";# Puts details of first image of collection into easier variableif(ExecuteQuery($linkdb,$result,$query)){	$row=NextRow($result);	$firstimage = $row['id'];}?><title><?php print($collection); ?></title></head><body><?php# If no image id sent, prints the introduction to the collectionif (!@$id) {	print("<h1>".$collection."</h1>\r");	print("<div class=\"intro\">{$intro}</div>\r");	print("<div class=\"bottom\"><a href=\"index.php\" target=\"_top\">change collection</a> | <a target=\"image\" href=\"images.php?colid={$colid}&amp;id={$firstimage}\">view first image...</a></div>\r");# Otherwise, the page will retrieve the image from table 'photo' that matches the id supplied} else {$query = "SELECT * FROM photo WHERE id={$id} AND active='y'";if(ExecuteQuery($linkdb,$result,$query)){	while($row=NextRow($result)){		$title = $row['name'];		$description = $row['description'];		$img_size= $row['image_size'];	}}?><div id="nav"><?php# This works out the id of the the previous and next images in the collection if they exist$query = "SELECT * FROM photo WHERE collection={$colid} AND active='y' ORDER BY id ASC";if(ExecuteQuery($linkdb,$result,$query)){	while($row=NextRow($result)){		if($row[0]<$id){		$previd=$row[0];		}		if($row[0]>$id){		$nextid=$row[0];		break;		}	}}# This displays the appropriate navigation buttonsif(@$previd){ ImageLink("images.php?colid={$colid}&amp;id={$previd}","images/previous.gif","previous image");}ImageLink("images.php?colid={$colid}","images/home.gif","collection intro");if(@$nextid){ImageLink("images.php?colid={$colid}&amp;id={$nextid}","images/next.gif","next image");}?></div><h1><?php print($title) ?></h1><div id="image"><img src="showblob.php?id=<?php print $id; ?>" alt="<?php print $description;?>" <?php print $img_size; ?> /></div><div class="bottom">other collections: <a href="index.php" target="_top">home</a> <?php$query = "SELECT * FROM collections WHERE id!={$colid} AND active='y'";if(ExecuteQuery($linkdb,$result,$query)){	while($row=NextRow($result)){	print(" | <a target=\"_top\" href=\"collection.php?colid={$row[0]}\">{$row[1]}</a>");		}}?>
</div>

<?#Closing bracket for else statement above
} ?></body></html>